\documentclass[12pt,a4paper]{report}
\usepackage{anysize}
\marginsize{20mm}{10mm}{20mm}{20mm}

\usepackage[utf8]{inputenc}
\usepackage{array}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage[export]{adjustbox}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{epstopdf}

\titleformat{\chapter}[hang] 
{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{1em}{} 

\graphicspath{ {./imgs/} }
\renewcommand*\contentsname{Table of contents}

\onehalfspacing

% for increasing cells line height in a table
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\newcolumntype{N}{@{}m{0pt}@{}}

\begin{document}
\pagestyle{plain}
\renewcommand{\chaptername}{}

\begin{singlespacing}
\tableofcontents
\end{singlespacing}


\addcontentsline{toc}{chapter}{Introduction}
\chapter*{Introduction}

\chapter{Domain analysis and model}
Domain analysis
\section{System Requirements}
\section{Medical Analysis}
\subsection{Difference between snoring and Sleep Apnea disorder}
Sometimes snoring and Sleep Apnea are used interchangeably, but from the medical point of view the terms represent different concepts. For the sake of being accurate, it is absolutely necessary to define each of them.

Snoring is the vibration of respiratory structures and the resulting sound. It is caused by the obstructed air movement during breathing while sleeping. From the intuitive point of view, snoring is simple to imagine and even mimic. This noisy, rough sound is created from the vibrations of uvula and soft palate. Uvula and soft palate are presented in Figure \ref{fig:uvula_and_soft_palate}.

\begin{figure}[h]
\centering
\includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.5]{01_uvula_and_soft_palate.jpg}
\caption{Uvula and soft palate}
\label{fig:uvula_and_soft_palate}
\end{figure}


Even though snoring is common among people of all ages, the whole issue stays relatively undiagnosed and poorly researched. The primary reason might be the fact that snoring itself isn't harmful. A person snoring during his sleep, might be perfectly healthy with no disorders whatsoever. Nevertheless snoring remains to be a social problem for people who share a bed. The sleeping partner can develop sleep difficulties in such cases.

The causes of snoring might be:
\begin{itemize}
 \item Throat weakness, which causes the throat to close during sleeping
 \item Being overweight - the fat around the neck puts pressure on the airways
 \item Nose blockage caused by crooked, bent or deformed nasal septum (the structure that separates the nostrils)
 \item Abnormalities in the bones of the face, like the mispositioned jaw
 \item Nasal polyps
 \item Stuffed nose during cold and allergies
 \item Consumption of relaxants like drugs or alcohol at bedtime
 \item Position during sleep, which may result in dropping one's tongue in the back of the mouth
\end{itemize}

Snoring itself is not dangerous, but can lead to several minor life discomforts, like daytime drowsiness, lack of a partner due to its psychosocial impact, decreased libido, lack of focus.

The real risks come up when talking about Sleep Apnea. It is a serious disorder in which one can have one or more pauses in breathing or shallow breaths while sleeping. The pauses in breathing are called apneas and can last from few seconds to several minutes. The shallow breathing event is called hypopnea. 

There are different types of Sleep Apnea:
\begin{itemize}
 \item Central Sleep Apnea (CSA) - breathing is interrupted by a lack of respiratory effort
 \item Obstructive Sleep Apnea (OSA) - breathing is interrupted by a physical block to the airflow despite respiratory effort
 \item Mixed Sleep Apnea (MSA) - contains properties from both types of Sleep Apnea
\end{itemize}

CSA is associated with a number of different neurological problems, when during sleep brain signals that tell the body to breath don't work properly. Respectively no effort is made to inhale as expected. Typically CSA is not associated with any snoring, therefore its detection and diagnosis goes beyond the scope of this work. In contrast in case of OSA an effort to breath is made, but because of the collapse of the upper airway, air doesn't get into the lungs.

% !!! REFERENCE
According to [1] CSA is the most rarely met and constitutes 0.4\% prevalence. Mixed or Complex Sleep Apnea is met 15\% of times. The most often is OSA - 84\%. Therefore OSA represents the most curious and interesting type of Sleep Apnea disorder, and it is the type that causes snoring due to the air squeeze past the blockage. 

Sleep Apnea is also characterized by the frequency of apneas. There exists 2 indexes can measure Sleep Apnea objectively: 
\begin{itemize}
 \item Apnea Hypopnea Index (AHI) - total number of apneas and hypopneas during an hour
 \item Respiratory Disturbance Index (RDI) - total number of apneas, hypopneas and respiratory-effort related arousals (RERAs) during an hour
\end{itemize}

The AHI and RDI can tell the severeness of OSA. Mild OSA ranges from 5 to 14.9 events per hour, moderate OSA - from 15 to 29.9 events per hour of sleep and severe OSA means having over 30 events per hour of sleep. The following formalization is disputable, since the diagnosis of OSA must include also a series of other factors about the patient, like age, blood saturation, heart rate.

As well as mere snoring, OSA is caused most often by structural features, low muscle tone and soft tissue around the airway. The risk of being diagnosed rises with age, increased body weight and active smoking. Indeed elderly people are more likely to have OSA. Normally men are more exposed to the disorder than women or children. Though is it not uncommon for children to suffer from OSA and manifest snoring during night. 

% !!! REFERENCE
According to “National Heart, Lung, and Blood Institute”[2] most common symptoms of sleep apnea are:
\begin{itemize}
 \item Loud snoring
 \item Waking up with a very dry sore or dry throat
 \item Occasionally waking up with a choking or gasping sensation
 \item Sleepiness and lack of energy during the day
 \item Restless sleep
 \item Sleepiness during driving
 \item Forgetfulness, mood changes, irritability, anxiety and depression
 \item Morning headaches
\end{itemize}

Most of the signs of OSA are vague and hard to measure. Many of those can be caused by tens of different physical and psychological disorders. Therefore the most obvious is load and chronic snoring.

Here is a simple illustration of a man sleeping without obstruction (Figure \ref{fig:sleep_without_obstruction}) and with obstruction (Figure \ref{fig:sleep_with_obstruction}). Blue arrow indicate oxygen flow, orange arrows - carbon dioxide flow.

\begin{figure}[h]
\centering
\includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.5]{02_sleeping_without_obstruction.png}
\caption{Sleeping without obstruction}
\label{fig:sleep_without_obstruction}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.5]{03_sleeping_with_obstruction.png}
\caption{Sleeping with obstruction}
\label{fig:sleep_with_obstruction}
\end{figure}

By defining both terms, it is possible now to see the differences between two and to establish a strong correlation between OSA and snoring. In simple words, it is clear that not any snoring is caused by OSA and almost every OSA patient will suffer from snoring during sleep.

\subsection{Risks and diagnosis of Obstructive Sleep Apnea disorder}
As it was stated above Obstructive Sleep Apnea is a rather serious disorder. Although a very minor degree of OSA is considered not dangerous and within the limits of normal sleep. The other small percentage of people with OSA are in the risk zone.

Firstly OSA can lead to high blood pressure. The following is explained by the fact that nighttime waking causes the hormonal system to go into overdrive. Additionally the reduction in blood oxygen saturation that happens due to the pauses in breathing, also can cause elevated arterial pressure (hypertension).

The most serious consequence of OSA is considered the heart disease. On average people with sleep apnea have 30\% higher risk of having a heart attack than those who don't have OSA. Chronic sleep apnea can cause congestive heart failure, called cor pulmonale. Speaking in simple terms, low oxygen level and midnight waking stress lead to strokes and atrial fibrillation.

It is known that 80\% of diabetics have OSA. Thought a direct link between the two was never proved, studies show that sleep deprivation causes insulin resistance. 

Same strange link between OSA and asthma exists. If sleep apnea is being treated, than patients report a decrease in asthma attacks. 

Previously it was stated that obesity is a cause for sleep apnea and two thirds of people suffering from OSA are extremely overweight. Obesity in this case act also as a consequence of sleep apnea, because it impairs the endocrine system of the human body, causing the release of the hormone ghrelin, which makes people crave carbohydrates and sweets. Moreover OSA can caused lower metabolism, because of the patient feeling sleepy and tired. Consequently it is necessary to treat OSA first, in order to feel better, be active and do exercises to lose weight.

% !!! REFERENCE
Car accidents are a very important consequence of untreated OSA. Several studies [4] and [5] show the same results - people with sleep apnea syndrome have an increased risk of automobile accidents. Patients with sleep apnea often report falling asleep while driving as least once per week. Generally impaired drivers with Sleep Apnea may cause many auto accidents. 

% !!! REFERENCE
According to Morbidity and Mortality Weekly Report from Centers for Disease Control and Prevention[3] drowsy driving has been responsible for an estimated 1500 fatalities and 40000 nonfatal injuries annually in the United States. Populations previously found at greatest risk included persons aged 16--29 years (particularly males), those with untreated sleep apnea syndrome or narcolepsy, and those who work shifts, particularly night shifts or extended shifts.

% !!! REFERENCE
Some of the latest statistics [6] claim that 5\% of all people have sleep apnea disorder. 37.9\% unintentionally fell asleep during the day at least once per month and 4.5\% nodded off or fell asleep while driving in the last month.

There are several ways to diagnose sleep apnea. Normally it should be a quintessential analysis of clinical symptoms and some formal sleep investigations. Clinical symptoms include daytime sleepiness, anxiety, fatigue and others discussed earlier. The formal sleep study can be conducted in the lab or at home. 

Polysomnography is the most complex sleep study. It involved a multi-parametric test that records biophysiological changes that occur during sleep. The result of this test is called Polysomnogram (PSG). A PSG will record heart rhythm, brain activity (EEG), eye movements (EOG), muscle activity and skeletal muscle activation (EMG). 

Usually the patient comes to the sleep lab and is wired up to multiple sensors that are attached to multiple channels of data. During the night a technician observes sleep activity by looking at the monitors and computers screen, that displays all the data. Consequently all the recorded data will be analysed manually by specialists in the field.

Polysomnographic test can be conducted also at home. Sophisticated home studies can give the same accuracy, but are quite complex and time consuming to set up for self monitoring. That is the reason why special screening tools are used for home-based test. Special equipment is given to the patient. Usually it consists of an thermistor (airflow measuring device) and a pulse oximeter (blood oxygen monitoring device). The patient would sleep at home with the device and after one or more nights will return it to the physician. 

In case of sleep apnea polysomnographic test characterizes pauses in breathing. These pauses are followed by a relative decrease in blood oxygen and an increase in the blood carbon dioxide. In case of CSA there are no chest movements whatsoever, but in case of OSA - the movements typically become even more pronounced. Based the results of polysomnographic test, AHI is deducted. 

For non-invasive method of monitoring blood oxygenation an oximeter (Figure \ref{fig:oximeter}) is being used. Howether an oximeter doesn't measure any apneic events or respiratory event-related arousals, hence doesn't produce any AHI value.

\begin{figure}[h]
\centering
\includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.5]{04_oximeter.jpg}
\caption{Oximeter}
\label{fig:oximeter}
\end{figure}

Lately all sorts of gadgets and devices started to appear to measure sleep apnea. There exists a big variety of portable monitors available on the market. Here is a classification of PSG types by American Academy of Sleep Medicine and novel devices.

\begin{figure}[h]
\centering
\includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.8]{05_psg_classification.jpg}
\caption{PSG classification}
\label{fig:psg_classification}
\end{figure}

% !!! REFERENCE
Full overnight polysomnographic test is considered the golden standard - type I. Most of the portable monitors are of type III and IV [8]. Even though portable monitors start gaining in attention, their proper usage is more challenging and the interpretation of results more vague.

In conclusion OSA is a serious disorder that should be treated as soon as possible, because it can lead to some unwanted consequences. There are many ways to identify OSA by consulting a doctor and taking a PSG test. The main gap that exists in problem solving is how do people suspect that they have OSA and decide to pay a visit to the doctor. This is the question that the following work is trying to clear up.

\subsection{Treatment of Obstructive Sleep Apnea disorder}
There are different ways to treat OSA depending on the severeness of the disorder. Firstly the patient will be asked to quit smoking, avoid alcohol and any other medicamentation that relax the central nervous system. If the patient is overweight, it is a good idea to lose some weight. Generally physical exercises will improve sleep apnea. If it's possible the patient should sleep on the side as opposed to sleeping on the back. Meanwhile the patient can use special anti-snoring sleeping pillows, that keep the head aligned to the body without dropping it too much in the back or to the front. Very often the elevated position helps prevent the gravitational collapse of the airway. All those solutions are simple, straightforward and don't require any serious medical intervention.

Possibly physical intervention for curing OSA is the most popular one. Positive airway pressure is the technique where a breathing device pumps a controlled stream of air through a mask worn over the nose, mouth or both. The idea behind the positive airway pressure is simple - it keeps the relaxed areas open.  There are a bunch of variations of positive airway pressure devices:
\begin{itemize}
 \item CPAP (Continuous Positive Airway Pressure) - a device that continuously pumps air to the nose and mouth
 \item VPAP (Variable Positive Airway Pressure) - a more sophisticated device that controls the stream of air. It pumps a higher pressure of air on inhalation and a lower pressure on exhalation. It can be used when patients have problems exhaling against an increased pressure airflow.
 \item APAP (Automatic Positive Airway Pressure) - the functional part is similar to previous examples, but uses a bunch of sensors to continuously monitor patient's breathing.
 \item Nasal EPAP (Expiratory Positive Airway Pressure) - uses person's breath to create the pressure
\end{itemize}

CPAP (Figure \ref{fig:cpap}) in comparison with many oral appliances is considered the most effective device for preventing sleep apnea. Mandibular advancement splint is an oral appliance that shifts the lower jaw forward and opens the bite slightly. This kind of specially fabricated appliances are efficient for people with mild or average form of sleep apnea.

\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio]{06_cpap.jpg}
\caption{CPAP - Continuous Positive Airway Pressure}
\label{fig:cpap}
\end{figure}

The usage of medicamentation was never proved to be effective in case of sleep apnea treatment. Usually Central Sleep Apnea can be treated with such drugs as acetazolamide, zolpidem and triazolam.

Surgery is also an alternative option to reduce severe sleep apnea. Even though surgery doesn’t give any guarantees to free up the patient from OSA and the evidence for all types of sleep surgery is quite poor. 

Some of the common types of surgeries are:
\begin{itemize}
 \item Tonsillectomy and/or adenoidectomy 
 \item Removal or the reduction of uvula and soft palate
 \item Nasal surgery, like turbinectomy or straightening of nasal septum
 \item Reduction of tongue base
 \item Moving the jaw a little bit up front and pulling the tongue away from the back of the airway
 \item Maxillomandibular advancements
\end{itemize}

Some of those surgeries can be conducted using Radiofrequency ablation (RFA). It uses low frequency radio wave energy to target tissue, causing coagulative necrosis. It is less common than CPAP or classical surgery, but has potential to become one.

% [Can be extended]

Those have been all the popular and most common ways to treat sleep apnea disorder. Neither of them gives absolute guarantee for a apnea-free life, but there exists a choice to make between invasive and non-invasive solutions. 

\section{Theoretical Analysis}
\subsection{Digital signal processing}
In the context of communication everything is a wave. This is the starting point to understanding that everything travels as a wave and can be represented graphically. Signals can be analog and discrete. Discrete-time signals consist of sequences of quantities. In case it is obtained from a continuous-time signal it is characterized by a sampling rate. The process of analog to digital conversion consists of 2 step process: quantization and discretization. If both time series and the amplitude of a signal were discretized, then it is a digital signal.

Digital signal processing (further used as DSP) represents a very important part in signal analysis. Since the major goal of this thesis is to develop an automated method for snore detection, digital signal processing becomes critical for correct computations. Roughly it might be considered a preprocessing phase in snore recognition, which is applied before feature extraction and machine learning. 

DSP is the mathematical manipulation of signal information represented in discrete domain: time, frequency. One type of such signal represents the sound of which we are particularly interested. Generally the aim of DSP is to improve the accuracy and reliability of discrete signals by eliminating or diminishing noise.

For the sake of clarity there will be presented a simple signal to which all the relevant digital processing algorithms will be applied.

First it is necessary to generate a sample wave. For the matter of simplicity the signal is generated using 2 sine waves as shown in Formula \eqref{eq:sample_sine}. The result is displayed in Figure \ref{fig:sines}. The lower plot shows the same signal as on the upper plot, plus some random normally distributed noise. Further we will use the noisy data to do preprocessing.

\begin{equation} \label{eq:sample_sine}
 y(t) = \sin(2\pi 0.05 x) + 3\sin(2\pi 0.09 x)
\end{equation}


\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.7]{07_sine_wave.eps}
\caption{Sample sine waves with and without noise}
\label{fig:sines}
\end{figure}

The most common way to improve the quality of a signal is to use digital filtering. It mainly consists of mathematical manipulations of a number of adjacent samples to a current sample. In preprocessing phase a low-pass filter is being used. It attenuates the high frequencies and passes low frequencies. It is characterized by the cut-off frequency, which should be specified explicitly for each signal. Low-pass filtering will make the signal appear smoother by removing short-term fluctuations. 

In this particular case the low-pass filter is implemented using Butterworth filter -- it has maximally flat frequency response in the passband. Butterworth filter introduces a phase shift between the original and filtered signal. In digital implementation the lag can be ignored, because the filtering happens twice, once forward and once backward. Second order 'lowpass' type filter is created for filtering the signal in this particular case. For the signal generated earlier the cutoff frequency is $10$. The results of filtering can be viewed in Figure \ref{fig:lowpass}.

\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.7]{08_lowpass.eps}
\caption{Sine wave with noise before and after low-pass filtering}
\label{fig:lowpass}
\end{figure}

From the resulted data, it is easy to see that signal becomes smoother and doesn't contains high frequencies. Mathematically and intuitively it gives a good-enough result. 

The next step is to perform normalization \eqref{eq:normalization}.

\begin{equation} \label{eq:normalization}
 x = \frac{x - \overline{x}}{\sigma}
\end{equation}

where $\overline{x}$ represents the arithmetic mean and $\sigma$ is the standard deviation. 

Consequently the signal wave is normalized and an example of normalization can be viewed in Figure \ref{fig:normalized}.

\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.7]{09_normalized.eps}
\caption{Sample sine wave normalized}
\label{fig:normalized}
\end{figure}

The best way to identify the missing fundamental frequency in a signal is to perform autocorrelation. Autocorrelation is a cross-correlation of a signal with itself. Mainly the autocorrelation yields repeating events from a signal. By definition for discrete time signal $x_n$ at time lag $j$, autocorrelation $R$ is

\begin{equation}
 R_{xx}(j) = \sum_{n}x_n\overline{x}_{n-j}
\end{equation}

Nevertheless one of the most computationally cheap ways to perform autocorrelation is do the inverse Fourier transform of the product of the discrete Fourier transform with the conjugate of the previously computed Fourier transform. Discrete Fourier transforms can be performed using FastFFT algorithm.

\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.7]{10_autocorrelation.eps}
\caption{The autocorrelation of the sine wave}
\label{fig:autocorrelation}
\end{figure}

All the manipulations performed till this point were done in time domain. In time domain one can see the changes that happen to a signal over time, whereas in frequency domain one can observe how much of the signal lies within each frequency band over a range of frequencies. Normally signals can be converted from one domain to the other using transformations like Fourier series, Fourier transform, Laplace Transform, Z transform. 

As previously mentioned Fourier transform performs a mathematical transformation from time to frequency domain and vice-versa. In engineering FFT (Fast Fourier Transform) algorithm is used widely due to its rapid computations. It factorizes the DFT (Discrete Fourier Transform) matrix into a product of sparse factors.  The DFT is defined by the Formula \eqref{eq:dft}.

\begin{equation} \label{eq:dft}
 X_k = \sum_{n=0}^{N-1} x_n e^{-i2\pi k\frac{n}{N}}, \qquad k= 0,\ldots , N-1
\end{equation}

Equation \eqref{eq:dft} has $O(N^2)$ complexity. In comparison, all known FFT algorithms require $\Theta (N \log N)$ operations, which represents a major improve in speed. FFT can also be used in computing Power Spectral Density (further used as PSD).

PSD shows how the variance of data is distributed over the frequency domain and represents a very useful tool to identify oscillatory signals in time series. On $x$ axis it represents the signal frequencies and on $y$ axis the amplitude. 

\begin{figure}[h]
\centering
  \includegraphics[max height=\textheight, max width=\textwidth, keepaspectratio, scale=0.7]{11_psd.eps}
\caption{Power Spectral Density of the signal}
\label{fig:psd}
\end{figure}

In Figure \ref{fig:psd} it is clearly seen a peak at about $0.05$ and a nearby point at $0.09$. Both points represent the initial frequencies that we used to generated the signal. 

To conclude DSP offered a variety of tools and algorithms to manipulate the initial noisy signal in order to achieve a concise representation with the most relevant information.

\subsection{Feature extraction and supervised learning}


\chapter{System design}
System design
\section{UML modeling}

\chapter{System Development}
System Development
\section{Implementation}
\section{Deployment}
\section{Testing}
\section{Results}

\chapter{Economic Analysis}
\section{Project description}
For the last several decades Information Technology has advanced like no other field in the history of humankind. The development of fast computers and optimized algorithms has opened a big field for medical appliances and analysis of medical data. Respectively big and small health problems can now be solved much easily. Sleep Apnea is a serious disorder, which should be addressed by everybody. Since the process of going through a polysomnographic test is a hideous technique, a lot of other ways of detecting Sleep Apnea are proposed. In a society where healthcare has one of the biggest priorities, it is reasonable to develop applications for detecting or solving health problems. Snoring issues are considered a nuisance and are gladly removed from one's life.

From this perspective is it clear why a snore and Sleep Apnea detecting application is a very useful and desired one. It can be used both in professional medical field by experts that want to automate and help their patients get comfortable with solutions that they offer, and additionally it is a perfect choice for those who suspect health problems and wish to identify the heaviness of snoring. 

As a cross-platform application it is flexible and easy to deploy on various platforms. Users of different ages with suspected snoring problems can run the application. It has a simple and intuitive interface. The application requires a device with a microphone -- this is so far the biggest requirement.

\section{Project time schedule}
For the accomplishment of a project it is necessary to establish a schedule. For the development of the snore detecting app, agile project management is applied to offer flexible and iterative method of designing the application. It goes in 5 stages: planning, research, development, testing and deployment. The steps are repetitive and incremental.

\subsection{Objective determination}
The main objective of the following project is to provide a complete and functioning application for snore detection. Otherwise without a finished product there is no profit. More to that, it is important to market the application and get exposed to a large audience in need. This can be done via medical institutions that can provide the software to their patients. Another way is to market oneself on platform-specific stores. Since it is not a common piece of software, it creates a very specific audience of users, the ones that have a real demand in snore recognition. 

The other crucial objective is to be as precise as possible. Since it deals with one's health, it becomes no joke. Even though the application states its status of being not responsible for the results and advices it gives, it is still a big influence on one's health decisions. 

To keep up with the latest trends and researches, it is also an essential objective to keep updated and provide enhancements to the software. The lifecycle of the application will require bugfixes, interface changes, feature implementations. All of that will help the system still be trendy and up-to-date on the market.

\subsection{Time schedule establishment}
As it was said above the project will iterate over 5 steps: planning, research, development, testing and deployment. Naturally as most of the IT projects, it is subdivided into smaller parts. Planning step isn't supposed take up a lot of time, since the requirements are flexible. Moreover due to the research part the design solutions can change over time and open up new perspectives. The process of development is being split up in smaller tasks that can be accomplished within a 2-5 day period. Total duration of the project is computed using Formula \eqref{eq:duration}.

\begin{equation} \label{eq:duration}
 Duration = StartDate - FinishDate + ReserveTime
\end{equation}

In table \ref{table:schedule} is presented the first iteration of the project schedule. It uses the following notations: 
\begin{itemize}
 \item PM -- project manager
 \item SA -- system architect
 \item SM -- sales manager
 \item D -- developer
\end{itemize}

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{1.5em} | M{14em} | M{4em} | M{7em} | M{10em} |N}
\hline
\textbf{Nr} & \textbf{Activity Name} & \textbf{Duration} & \textbf{People involved} & \textbf{Comments} &\\[18pt]
\hline
1 & Define the project concept and objectives & 5 days & PM, SA, SM, D & It is a common task &\\[14pt]
\hline
2 & Perform market analysis & 10 days & PM, SA & Will results into a document describing market analysis &\\[14pt]
\hline
3 & Analysis of the domain & 15 days & SA, D & Research of the recognition algorithms &\\[14pt]
\hline
4 & Write down requirements and specifications & 5 days & PM, SA, D & &\\[14pt]
\hline
5 & System design (UML) & 10 days & PM, SA, D & &\\[14pt]
\hline
6 & Database design & 3 days & PM, SA, D & Development database and end-user database schemes &\\[14pt]
\hline
7 & Preprocessing and learning part of the implementation & 30 days & PM, SA, D & &\\[14pt]
\hline
8 & End-user application development & 20 days & PM, SA, D, SM & &\\[14pt]
\hline
9 & Validation of results & 10 days & PM, SA, D, SM & &\\[14pt]
\hline
10 & Documentation & 5 days & D & &\\[14pt]
\hline
11 & Deployment and testing & 10 days & PM, SA, D & &\\[14pt]
\hline
12 & Active marketing & 5 days & SM & &\\[14pt]
\hline
13 & Total time to finish the system & 128 days & & &\\[14pt]
\hline
\end{tabular}
\caption{Time schedule}
\label{table:schedule}
\end{center}
\end{table}

Table \ref{table:schedule} describes the activities that will occur during project development, who is involved into each process and how much time does it take to accomplish a task. Total amount of time spent on the following project is 128 days.

\section{Economic motivation}
The following section describes the evaluation of the project from the economic point of view. That includes the total profit, number of potential clients, salaries that have to be paid to employees, revenues that the company gets by commercializing the product. All the costs and prices are given in MDL (Moldavian lei) currency. Tangible and intangible assets, indirect expenses will also be taken into account. Wear and depression in regard to final product will also be computed.

\subsection{Tangible and intangible asset expenses}
The budget for the required assets is shown in Table \ref{table:tangible_assets}, Table \ref{table:intangible_assets}, Table \ref{table:direct_expenses}.

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{5em} | M{10em} | M{7em} | M{5em} | M{5em} | M{5em} |N}
\hline
\textbf{Material} & \textbf{Specification} & \textbf{Measurement unit} & \textbf{Price per unit (MDL)} & \textbf{Quantity} & \textbf{Sum (MDL)} &\\[18pt]
\hline
Computer & Lenovo X201 i5 processor & Unit & 10000 & 1 & 10000 &\\[14pt]
\hline
Smartphone & Nexus 5 & Unit & 8500 & 1 & 8500 &\\[14pt]
\hline
Single-board computer & Raspberry Pi Model B  & Unit & 600 & 1 & 600 &\\[14pt]
\hline
USB microphone & Logitech Labtec Microphone & Unit & 600 & 1 & 600 &\\[14pt]
\hline
Total & & & & & 19700 &\\[14pt]
\hline
\end{tabular}
\caption{Tangible asset expenses}
\label{table:tangible_assets}
\end{center}
\end{table}

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{5em} | M{10em} | M{7em} | M{5em} | M{5em} | M{5em} |N}
\hline
\textbf{Material} & \textbf{Specification} & \textbf{Measurement unit} & \textbf{Price per unit (MDL)} & \textbf{Quantity} & \textbf{Sum (MDL)} &\\[18pt]
\hline
License & Enterprise Architect Desktop Edition License & Unit & 1900 & 3 & 5700 &\\[14pt]
\hline
License & PyCharm Commercial License & Unit & 2800 & 3 & 8400 &\\[14pt]
\hline
Total & & & & & 14100 &\\[14pt]
\hline
\end{tabular}
\caption{Intangible asset expenses}
\label{table:intangible_assets}
\end{center}
\end{table}

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{5em} | M{10em} | M{7em} | M{5em} | M{5em} | M{5em} |N}
\hline
\textbf{Material} & \textbf{Specification} & \textbf{Measurement unit} & \textbf{Price per unit (MDL)} & \textbf{Quantity} & \textbf{Sum (MDL)} &\\[18pt]
\hline
Paper & A4 & 500 sheets & 60 & 1 & 60 &\\[14pt]
\hline
Whiteboard & Universal Dry Erase Board & 500 & Unit & 1 & 500 &\\[14pt]
\hline
Marker & Whiteboard marker & Unit & 10 & 5 & 50 &\\[14pt]
\hline
Pen & Blue pen & Unit & 3 & 3 & 9 &\\[14pt]
\hline
Total & & & & & 619 &\\[14pt]
\hline
\end{tabular}
\caption{Direct expenses}
\label{table:direct_expenses}
\end{center}
\end{table}

So the total amount of direct expenses represents 

\begin{equation}
 19700 + 14100 + 619 = 34419 lei
\end{equation}

\subsection{Salary expenses}
The employees obviously should be paid accordingly. Hence this section is concerned about the salaries to employees and various funds that should be paid. The distribution of salaries is the following: project manager -- 350 lei, system architect -- 450 lei, sales manager -- 300 lei, developer -- 420 lei. Those expenses are introduces in Table \ref{table:salaries}.

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{10em} | M{8em} | M{8em} | M{8em} |N}
\hline
\textbf{Employee} & \textbf{Work fund (days)} & \textbf{Salary per day (MDL)} & \textbf{Salary fund (MDL)}&\\[18pt]
\hline
Project Manager & 103 & 350 & 36050 &\\[14pt]
\hline 
System Architect & 108 & 450 & 48600 &\\[14pt]
\hline
Sales Manager & 40 & 300 & 12000 &\\[14pt]
\hline
Developer & 113 & 420 & 47460 &\\[14pt]
\hline
Total & & & 144110 &\\[14pt]
\hline
\end{tabular}
\caption{Salary expenses}
\label{table:salaries}
\end{center}
\end{table}

Now by having computed all the salaries for the employees, it is time to compute how much to be paid to social services fund, medical insurance fund and the total work expenses by summing up all previous expenses. So the social service fund which is $23\%$ this year will be 

\begin{equation}
 FS = F_{re} \cdot T_{fs} = 144110 lei \cdot 23 \% = 33145.3 lei 	
\end{equation}

where $F_{re}$ is the salary expense fund and $T_{fs}$ is the social service tax approved each year.

The medical insurance fund is computed as

\begin{equation}
 MI = F_{re} \cdot T_{mi} = 144110 lei \cdot 3.5 \% = 5043.85 lei
\end{equation}

where $T_{mi}$ is the mandatory medical insurance tax approved each year by law of medical insurance and this year it is $3.5\%$. 

So now having computed social service tax and medical insurance tax, it is possible to compute total work expense fund as follows

\begin{equation}
 WEF = F_{re} + FS + MI = 144110 lei + 33145.3 lei + 5043.85 lei = 182299.15 lei
\end{equation}

where $WEF$ is the work expense fund, FS is the social fund and MI is the medical insurance fund. In that way the total work expense fund was computed. 

\subsection{Individual person salary}
Along with total work expense fund, it is necessary to compute the annual salary for the developer. Considering that the developer has a salary of 420 lei per day and there are totally 250 working days in the year, so the gross salary that the developer get is

\begin{equation}
 Gross Salary = 420 lei \cdot 250 days = 105000 lei
\end{equation}

Social fund tax this year represents $6\%$, so the amount that should be tax paid is

\begin{equation}
 Social Fund = 105000 lei \cdot 6\% = 6300 lei
\end{equation}

Medical insurance tax represents $3.5\%$ and gives the following result

\begin{equation}
 Medical Insurance Fund = 105000 lei \cdot 3.5\% = 3675 lei 
\end{equation}

In order to proceed with income tax computations, it is necessary to calculate the amount of taxed salary.

\begin{equation}
\begin{split}
 Taxed Salary &= Gross Salary - Social Fund - Medical Insurance Fund \\
	      & - Personal Exemption - Supported Person Exemption \\
              &= 105000 - 6300 - 3675 - 9120 - 2040 = 83865
\end{split}
\end{equation}

The last but not the least thing to be computed is the total income tax, which is $7\%$ for income under 26700 lei and $18\%$ for income over 26700 lei.

\begin{equation}
\begin{split}
 Income Tax &= Taxed Salary - Salary Tax \\
	    &= 26700 \cdot 7\% + (83865 - 26700) \cdot 18\% \\
	    & = 1869 + 10289.7 = 12158.7 lei
 \end{split}
\end{equation}

With all this now it is possible to find out what's going to be the net income.

\begin{equation}
\begin{split}
 Net Salary &= Gross Salary - Income Tax - Social fund - Medical Insurance Fund \\
            &= 105000 - 12158.7 - 6300 - 3675 = 82866.3 lei
\end{split}
\end{equation}

\subsection{Indirect expenses}
The indirect expenses are things like electricity, Internet traffic, water, etc. Those will be presented in Table \ref{table:indirect_expenses}.

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{5em} | M{10em} | M{7em} | M{5em} | M{5em} | M{5em} |N}
\hline
\textbf{Material} & \textbf{Specification} & \textbf{Measurement unit} & \textbf{Price per unit (MDL)} & \textbf{Quantity} & \textbf{Sum (MDL)} &\\[18pt]
\hline
Internet & Moldtelecom & Pack & 200.00 & 3 & 600.00 &\\[14pt]
\hline
Transport & Public bus & Trip & 3.00 & 132 & 396 &\\[14pt]
\hline
Phone & Moldtelecom & Pack & 30.00 & 3 & 90 &\\[14pt]
\hline
Electricity & Union Fenosa & KWh & 1.10 & 250 & 275 &\\[14pt]
\hline
Total & & & & & 1361 &\\[14pt]
\hline
\end{tabular}
\caption{Indirect expenses}
\label{table:indirect_expenses}
\end{center}
\end{table}

\subsection{Wear and depreciation}
Another important part of economic analysis is the computation of wear and depreciation. It is a well known fact that any product decreases its value with time. Depression will be computed uniformly for the whole project duration, so that there are no accountancy issues. In other words, if a product is planned for 3 years, it should be divided into 3 uniform parts according to each year. Straight line depreciation will be applied. Normally wear is computed regarding to the type of asset. The notebook and single-board computer are usable for a period of 3 years. Licenses will last for a single year. At first tangible and intangible assets are summed up and then the salvage costs of each of the items at the end of their period of use has to be subtracted:

\begin{equation}
 \begin{split}
  Total Asset Value &= \sum_{} (AssetCost - Salvage Value) \\
		    &= (10000 - 200) + (8500 - 200) + (600 - 200) + (600 - 200) +\\
		    & + (5700 - 200) + (8400 - 200) \\
		    &= 32600 lei
 \end{split}
\end{equation}

In order to get the yearly wear, divide total asset value by the period of use of assets

\begin{equation} \label{eq:wear}
 \begin{split}
  Wear Per Year &= Total Asset Value / Period Of Use \\
                &= 32600 lei/3 years= 10866.66 lei
 \end{split}
\end{equation}

Formula \eqref{eq:wear} included tangible assets which will last for 3 years and intangible assets which last only one year. The initial value of assets was

\begin{equation}
 InitialAssetValue = Tangible Assets + Intangible Assets = 19700 + 14100 = 33800 lei
\end{equation}

With all the information above it is possible to build the depreciation table, presented in Table \ref{table:depreciation}.

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{10em} | M{10em} | M{10em} | M{10em}|N}
\hline
\textbf{Assets value at the beginning of year (MDL)} & \textbf{Depreciation expense per year (MDL)} & \textbf{Accumulated depreciation at the end of year (MDL)} & \textbf{Assets value at the end of year (MDL)} &\\[18pt]
\hline
33800 & 10866.66 & 10866.66 & 22933.34 &\\[14pt]
\hline
25520 & 10866.66 & 21733.33 & 12066.67 &\\[14pt]
\hline
17240 & 10866.66 & 32600 & 1200 &\\[14pt]
\hline
\end{tabular}
\caption{Depreciation of assets}
\label{table:depreciation}
\end{center}
\end{table}

The project takes 128 days to be finish, respectively the wear value of the assets in this particular case should be

\begin{equation}
 \begin{split}
  ProjectWearValue &= WearPerYear / DaysInYear \cdot ProjectDuration\\
                   &= 10866.66 lei / 356 days \cdot 128 days = 3907.11 lei
 \end{split}
\end{equation}

\subsection{Product cost}
With all the project expenses computed, it is easy to compute the product cost which includes direct and indirect expenses, salary expenses and wear expenses as shown in Table \ref{table:product_cost}.

\begin{table}[!h]
\begin{center}
\begin{tabular}{| M{14em} | M{10em} | M{10em} |N}
\hline
\textbf{Expense type} & \textbf{Sum (MDL)} & \textbf{Percentage (\%)} &\\[18pt]
\hline
Direct expenses & 619 & 0.36 &\\[14pt]
\hline
Indirect expenses & 1361 & 0.85 &\\[14pt]
\hline
Salary expenses & 144110 & 90.08  &\\[14pt]
\hline
Social fund expenses & 6300 & 3.93 &\\[14pt]
\hline
Medical insurance expenses & 3675 & 2.29 &\\[14pt]
\hline
Asset wear expenses & 3907 & 2.44 &\\[14pt]
\hline
\textbf{Total product cost} & \textbf{159972} & \textbf{100} &\\[14pt] 
\hline
\end{tabular}
\caption{Depreciation of assets}
\label{table:depreciation}
\end{center}
\end{table}

\subsection{Economic indicators and results}
At this point it is crucial to sell the product to clients from medical institutions and end-users. The total product cost is very high, consequently there are 2 strategies that can be applied -- whether sell less with a high price or sell more with a lower price. It is not possible to add a percentage to the product cost that will represent the profit. It is assumed that the expected profit represents $15\%$ of the total product cost and the expected number of sold copies to be 1000. 

\begin{equation}
 \begin{split}
  Gross Price &= Total Product Cost / Number Of Copies Sold + Chosen Profit Percentage\\
              &= 159972 lei/1000 copies + 15\% = 183.96 lei
 \end{split}
\end{equation}

This is not the price of the end product, since it is necessary to add sales tax (VAT), which represents $20\%$ and is added to the gross price. 

\begin{equation}
 \begin{split}
  Sale Price (incl. TVA) &= Gross Price + Sales Tax\\
              &= 183.96 lei + 20\% = 220.75 lei
 \end{split}
\end{equation}

The net income is computed by multiplying gross price and the number of expected copies to be sold, which will be

\begin{equation}
 \begin{split}
  Net Income &= Gross Price \cdot Number Of Copies Sold\\
              &= 183.96 lei \cdot 1000 = 183960 lei
 \end{split}
\end{equation}

Moreover it is necessary to compute the gross and net profit. Gross profit is computed by subtracting cost of production from the net income. Net profit can be found by subtracting $12\%$ (because it is a legal entity) from the gross profit. The indicators are the following

\begin{equation}
 \begin{split}
  Gross Profit &= Net Income - Cost Of Production\\
              &= 183960 - 159972 = 23988 lei\\              
  Net Profit &= Gross Profit - 12\% \\
             &= 23988 - 12\% = 21109.44 lei
 \end{split}
\end{equation}

The profitability indicators are computed below:

\begin{equation}
 \begin{split}
  Cost Profitability &= Gross Profit / Cost Of Production \cdot 100\%\\
              &= 23988 / 159972 \cdot 100\% = 15 \%\\              
  SalesProfitability &= Gross Profit / Net Income \cdot 100\% \\
             &= 23988 / 183960 \cdot 100\% = 13 \%\\
  EconomicProfitability &= Gross Profit / Total Material Cost \cdot 100\%\\
                        &= 23988 / 34419 \cdot 100\% = 69.7 \%\\
 \end{split}
\end{equation}

\section{Economic conclusions}
The snore and Sleep Apner disorder application was analyzed from the economic point of view. It was computed the production cost, different profit and profitability indicators, various types of expenses involved, including direct, indirect, salary and taxes. The whole analysis is worth to understand if the product will be successful and if it's worth investing money in it. The biggest expense represents the intellectual equity, since it is critical to have a reliable product, which is based on extensive research and professional development techniques. The number of expected sold copies might be exaggerated, but it is decided that the product is targeted towards a wider audience. Considering that nowadays most of the individuals own a smartphone, it is easier to get into the market of mobile applications. Deployment is easy, therefore people tend to try different applications from the store. The price of the application can become a blocker, therefore it's price might be dropped. In such scenario other means of profit can be introduced, for example in-app advertisement. 

The commercialization of the product is not an easy task. Especially when the product is open sourced. Nevertheless high-quality service and customer support can be provided only to institutions and users that bought the product. The success of the product highly depends on financial strategy and solid economic analysis, which was presented in this chapter.

\addcontentsline{toc}{chapter}{Conclusions}
\chapter*{Conclusions}
Conclusions

\addcontentsline{toc}{chapter}{References}
\chapter*{References}
References

\end{document}